# RTSP Bruter - DESCRIBE 请求理念说明

## 项目概述
本项目是一个RTSP协议客户端工具，主要功能是实现RTSP协议中的DESCRIBE请求，用于获取媒体服务器上的媒体描述信息(SDP)。同时，该工具也提供了对RTSP服务器的认证暴力枚举功能，可用于安全测试和评估。

## DESCRIBE 请求的作用
在RTSP协议中，DESCRIBE请求用于向服务器请求指定媒体流的描述信息，通常以SDP(Session Description Protocol)格式返回。这些信息包括：
- 媒体流的数量和类型(音频/视频)
- 编码格式
- 传输协议
- 网络地址和端口信息

## 实现理念与设计原则

### 1. 模块化设计
- 将公共功能(请求构建、发送、响应读取、SDP解析)提取到`common.rs`模块中
- 客户端核心逻辑封装在`RtspClient`结构体中
- 错误处理封装在`error.rs`中
- 认证逻辑封装在`auth.rs`中

### 2. 健壮性与可靠性
- 全面的错误处理：使用`Result`类型处理各种可能的错误情况
- 超时机制：对连接建立、请求发送和响应读取设置超时
- 优雅处理认证挑战：支持Basic和Digest认证方式

### 3. 灵活性与适应性
- 随机User-Agent：模拟不同客户端，提高兼容性
- 可配置的请求参数：CSeq、Transport等
- 支持带认证和不带认证的RTSP服务器

### 4. 可调试性
- 详细的日志记录：记录请求、响应和关键操作
- 结构化的错误信息：便于问题定位

## 核心功能流程
1. **URL解析**：解析RTSP URL，提取主机、端口和路径
2. **连接建立**：建立TCP连接到RTSP服务器
3. **请求构建**：构建符合RTSP规范的DESCRIBE请求
4. **请求发送**：发送请求并处理可能的网络错误
5. **响应处理**：读取并解析服务器响应
6. **认证处理**：如果需要认证，生成认证头并重新发送请求
7. **SDP解析**：提取并解析响应中的SDP内容

## 代码结构
```
rust-rtsp-bruter/
├── src/
│   ├── main.rs       # 入口文件
│   ├── client.rs     # RTSP客户端实现
│   ├── common.rs     # 公共功能模块
│   ├── error.rs      # 错误定义
│   ├── auth.rs       # 认证处理
│   └── brute.rs      # 暴力枚举实现
└── README.md         # 项目文档
```

## 使用示例
```bash
cargo run -- rtsp://example.com:554/stream username password
```

## 暴力枚举功能
本工具的一个核心特性是支持对RTSP服务器进行认证暴力枚举，主要用于安全测试和评估。

### 暴力枚举的实现理念
1. **字典攻击**：尝试使用常见的用户名和密码组合进行认证
2. **并发处理**：利用Rust的异步特性，并行尝试多个认证请求
3. **智能暂停**：在多次失败后自动调整请求频率，避免被服务器屏蔽
4. **结果记录**：记录成功的认证凭据，便于后续分析

### 使用方法
```bash
# 基本使用（单用户名密码）
cargo run -- rtsp://example.com:554 username password

# 使用字典文件进行暴力枚举
cargo run -- --brute rtsp://example.com:554 users.txt passwords.txt
```

### 安全提示
- 此工具仅用于合法的安全测试和授权评估
- 未经许可对他人的RTSP服务器进行暴力攻击可能违反法律法规
- 使用前请确保您已获得相关授权

## 技术栈
- Rust语言
- Tokio异步运行时
- Chrono时间库
- Url解析库
- Log日志库